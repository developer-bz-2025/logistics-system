<div class="p-6">
    <div class="flex items-end justify-between gap-4 mb-4">
        <div>
            <h1 class="text-xl font-semibold">Search results</h1>
            <p class="text-sm text-gray-500">
                {{ total | number }} results for
                <span class="font-medium">"{{ (q$ | async) || '' }}"</span>
            </p>
        </div>


        <!-- (Optional) Filters row: add selects bound to BehaviorSubjects if needed -->
        <!-- Example placeholders (wire up as needed): -->
        <!-- <div class="flex gap-2">
<select class="border rounded-lg px-2 py-1 text-sm">
<option>All types</option>
</select>
<select class="border rounded-lg px-2 py-1 text-sm">
<option>All visibility</option>
</select>
</div> -->
    </div>


    <div *ngIf="loading" class="border rounded-xl p-6 text-gray-500">Searchingâ€¦</div>


    <div *ngIf="!loading && results.length === 0"
        class="border border-dashed rounded-xl p-10 text-center text-gray-500">
        No matching resources.
    </div>


    <div *ngIf="!loading && results.length > 0"
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5">
        <div *ngFor="let r of results"
            class="group bg-white border border-gray-200 rounded-2xl shadow-sm hover:shadow-md hover:border-gray-300 transition">
            <div class="p-4 pb-2 flex items-start gap-3">
                <!-- <div class="h-10 w-10 rounded-xl flex items-center justify-center bg-gray-50">ðŸ“„</div> -->
                <div class="h-10 w-10 rounded-xl flex items-center justify-center p-4"
                >
                {{ iconForType(r.type || '') }}
            </div>
                <div class="min-w-0 flex-1">
                    <div class="flex items-start gap-2">
                        <div class="font-medium truncate" [title]="r.res_title">{{ r.res_title }}</div>
                        <span class="ml-auto text-[10px] px-2 py-0.5 rounded-full"
                            [style.background]="visColor(r.visibility) + '22'" [style.color]="visColor(r.visibility)">
                            {{ r.visibility || 'â€”' }}
                        </span>
                    </div>
                    <div class="text-sm text-gray-500 line-clamp-2 mt-1" *ngIf="r.res_description">{{ r.res_description
                        }}
                    </div>
                    <div class="text-xs text-gray-400 mt-1">
                        <!-- {{ r.created_at | date:'mediumDate' }} -->
                        <span *ngIf="r.unit?.unit_name" class="ml-2"> {{ r.unit?.unit_name }}</span>
                        <span *ngIf="r.entity?.name" class="ml-2"> {{ r.entity?.name }}</span>
                    </div>
                    <div class="mt-2 flex flex-wrap gap-1">
                        <span *ngFor="let t of r.tags"
                            class="text-[10px] px-1.5 py-0.5 rounded bg-blue-100 text-black-700">#{{ t.name }}</span>
                    </div>
                </div>
            </div>
            <div class="px-4 pb-4 pt-2 flex items-center justify-between text-xs text-gray-500">
                <span>{{ r.created_at | date:'mediumDate' }}</span>

                <div class="flex items-center gap-2">
                    <a *ngIf="r.res_url && hrefFor(r.res_url) as href"
                        class="text-sm px-3 py-1.5 rounded-lg border hover:bg-gray-50" [href]="href"
                        target="_blank" rel="noopener">
                        Open
                    </a>
                </div>
            </div>

            <!-- <div class="px-4 pb-4 pt-2 flex items-center justify-end">
                <a *ngIf="r.res_url" class="text-sm px-3 py-1.5 rounded-lg border hover:bg-gray-50" [href]="r.res_url"
                    target="_blank" rel="noopener">Open</a>
            </div> -->
        </div>
    </div>


    <!-- Pagination -->
    <div *ngIf="!loading && lastPage > 1" class="mt-6 flex items-center justify-center gap-2">
        <button class="px-3 py-1.5 border rounded-lg text-sm disabled:opacity-50" [disabled]="currentPage === 1"
            (click)="onPageChange(currentPage - 1)">Prev</button>
        <span class="text-sm text-gray-600">Page {{ currentPage }} / {{ lastPage }}</span>
        <button class="px-3 py-1.5 border rounded-lg text-sm disabled:opacity-50" [disabled]="currentPage === lastPage"
            (click)="onPageChange(currentPage + 1)">Next</button>
    </div>
</div>