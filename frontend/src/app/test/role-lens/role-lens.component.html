<div class="rounded-2xl border bg-white shadow-sm overflow-hidden">
    <div class="px-5 py-4 border-b flex items-center justify-between gap-3">
      <div class="flex items-center gap-3">
        <div class="h-9 w-9 rounded-xl bg-violet-50 border flex items-center justify-center text-violet-600 text-lg">ğŸ§­</div>
        <div>
          <div class="font-semibold tracking-tight">Role-centric Lens</div>
          <div class="text-xs text-gray-500">Switch role to preview what employees see</div>
        </div>
      </div>
  
      <div class="flex items-center gap-2">
        <select class="px-3 py-2 border rounded-lg text-sm" [(ngModel)]="role">
          <option value="super_admin">Super Admin</option>
          <option value="c_level">Board</option>
          <option value="country_dir">Country Director</option>
          <option value="head_of_entity">Head of Entity</option>
          <option value="unit_admin">Unit Admin</option>
          <option value="standard">Standard</option>
        </select>
  
        <select class="px-3 py-2 border rounded-lg text-sm" [(ngModel)]="focusCountryId">
          <option [ngValue]="null">All countries</option>
          <option *ngFor="let c of countries; trackBy: trackByCountry" [ngValue]="c.id">{{ c.name }}</option>
        </select>
  
        <select class="px-3 py-2 border rounded-lg text-sm" [(ngModel)]="focusEntityName">
          <option [ngValue]="null">All entities</option>
          <option *ngFor="let en of entityNamesAll" [ngValue]="en">{{ en }}</option>
        </select>
      </div>
    </div>
  
    <div class="p-4 space-y-3">
      <div *ngFor="let c of countriesForRole(); trackBy: trackByCountry"
           [class.hidden]="focusCountryId && c.id !== focusCountryId">
        <div class="font-semibold mb-1">
          {{ c.name }} <span class="text-xs text-gray-500">Country</span>
        </div>
  
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-3">
          <div *ngFor="let e of entitiesForCountry(c); trackBy: trackByEntity" class="rounded-xl border p-3">
            <div class="flex items-center justify-between">
              <div class="font-medium">ğŸ¢ {{ e.name }}</div>
              <div class="text-xs text-gray-500">{{ e.units.length }} units</div>
            </div>
  
            <div class="mt-2 flex flex-wrap gap-1">
              <span class="px-2 py-0.5 rounded-full text-[11px] bg-sky-50 border border-sky-200 text-sky-700"
                    *ngFor="let h of e.heads">Head: {{ h }}</span>
            </div>
  
            <div class="mt-3 grid grid-cols-1 gap-2">
              <div *ngFor="let u of e.units; trackBy: trackByUnit" class="rounded-lg border p-2 bg-gray-50">
                <div class="flex items-center justify-between">
                  <div class="font-medium">{{ u.name }}</div>
                  <div class="text-xs text-gray-500">{{ (u.unit_admins.length + u.standards.length) || 0 }} users</div>
                </div>
                <div class="mt-1 text-xs">
                  <span class="inline-block mr-2">ğŸ§‘â€ğŸ’¼ Admins: {{ u.unit_admins.length }}</span>
                  <span>ğŸ‘¥ Standards: {{ u.standards.length }}</span>
                </div>
              </div>
            </div>
  
          </div>
        </div>
      </div>
    </div>
  </div>
  