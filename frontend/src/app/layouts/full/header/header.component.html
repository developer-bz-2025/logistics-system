<mat-toolbar class="topbar" style="background-color: #F9FAFB; border-bottom: 1px solid #E5E7EB;">
  <!-- Mobile Menu -->
  <button mat-icon-button (click)="toggleMobileNav.emit()" *ngIf="!showToggle">
    <i-tabler name="menu-2" class="icon-20 d-flex"></i-tabler>
  </button>
  <!-- --------------------------------------------------------------- -->

  <!-- --------------------------------------------------------------- -->
  <!-- Notification Dropdown -->
  <!-- --------------------------------------------------------------- -->

  <!-- <button mat-icon-button aria-label="Notifications">
    <i-tabler class="d-flex" name="bell" matBadge="1" matBadgeColor="primary"></i-tabler>
  </button> -->

  
  <!-- <div class="relative justify-self-center w-full max-w-md ml-28">
    <input type="text" [formControl]="q" placeholder="Search resources, descriptions, or #tag" (keyup.enter)="submit()"
      (keyup.escape)="clear()" (input)="onInput()"
      class="w-full border border-gray-300 rounded-lg px-3 py-2 pr-24 focus:outline-none focus:ring-2 focus:ring-blue-600 text-sm" />
    <button type="button" aria-label="Clear search" *ngIf="!isEmpty" (click)="clear()"
      class="absolute right-24 top-1/2 -translate-y-1/2 px-2 py-1 text-sm rounded-lg hover:bg-gray-100">
      âœ•
    </button>
    <button (click)="submit()"
    [disabled]="isEmpty"
    class="absolute right-1 top-1/2 -translate-y-1/2 px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
    Search
    </button>
  </div>
  <span class="flex-1-auto"></span> -->

  <!-- --------------------------------------------------------------- -->
  <!-- Notification Bell -->
  <!-- --------------------------------------------------------------- -->
  <button
    mat-icon-button
    aria-label="Notifications"
    (click)="navigateToNotifications()"
    class="relative mr-2">
    <i-tabler class="d-flex" name="bell"></i-tabler>
    <span
      *ngIf="unreadCount > 0"
      class="absolute top-0 right-0 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center"
      style="transform: translate(25%, -25%);">
      {{ unreadCount > 99 ? '99+' : unreadCount }}
    </span>
  </button>

  <!-- --------------------------------------------------------------- -->
  <!-- profile Dropdown -->
  <!-- --------------------------------------------------------------- -->
  <div class="ml-auto flex items-center gap-2">

    <span class="font-bold text-sm">Welcome {{ user?.name?.split(' ')[0] }}!</span>
    <!-- Profile Button -->
    <button mat-icon-button [matMenuTriggerFor]="profilemenu" aria-label="Profile"
    class="flex items-center justify-center">
    <span class="inline-flex w-8 h-8 items-center justify-center rounded-full text-white font-bold text-sm"
    [ngClass]="getGradientClass(user?.role.name)">
    
    {{ user?.name?.charAt(0).toUpperCase() }}
  </span>
  
</button>
</div>

  <!-- Profile Dropdown -->

  <mat-menu #profilemenu="matMenu" class="w-64 rounded-xl p-0 overflow-hidden shadow-xl border border-gray-200">

    <!-- User Info Section -->
    <div class="bg-gradient-to-br from-gray-100 to-white px-5 py-4">
      <div class="font-semibold text-gray-800 text-base">{{ user?.name }}</div>
      <div class="text-sm text-gray-500 truncate">{{ user?.email }}</div>
      <div class="text-xs font-medium mt-1 inline-block px-2 py-1 rounded-full text-white mt-4"
        [ngClass]="getGradientClass(user?.role.name)">
        {{ user?.role?.name === 'super_admin'
            ? 'Pro Admin'
            : (user?.role?.name.replace('_', ' ') | titlecase) }}
      </div>
      <div *ngIf="user?.role?.name === 'log_admin'" class="mt-4 text-sm text-gray-700">
        <!-- <div class="text-xs font-semibold uppercase text-gray-500 tracking-wide mb-2">Locations</div> -->
        <div class="flex flex-wrap gap-2">
          <span
            class="px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 text-xs font-medium"
            *ngFor="let location of user?.locations"
          >
            {{ location.name }}
          </span>
          <span *ngIf="!user?.locations?.length" class="text-gray-400 text-xs">No locations assigned</span>
        </div>
      </div>
      <!-- <div class="text-sm text-gray-500 truncate mt-4" *ngIf="user?.role!='super_admin' && user?.role!='c_level'">{{
        user?.unit_name }}, {{ user?.country_name }}, {{ user?.entity_name }}</div> -->

    </div>

    <!-- Divider -->
    <div class="border-t border-gray-200 my-1"></div>

    <!-- Change Password Button -->
    <div class="px-4 py-2">
      <a [routerLink]="['/authentication/change-password']" mat-stroked-button color="primary" class="w-full">
        Change Password
      </a>
    </div>

    <!-- Logout Button -->
    <div class="px-4 py-2 pb-3">
      <a [routerLink]="['/authentication/login']" mat-stroked-button color="primary" class="w-full">
        Logout
      </a>
    </div>
  </mat-menu>

  <!-- <button
  mat-icon-button
  [matMenuTriggerFor]="profilemenu"
  aria-label="Profile"
  class="flex items-center justify-center"
>
  <span class="inline-flex w-8 h-8 items-center justify-center rounded-full text-white font-bold text-sm"
        [ngClass]="getGradientClass(user?.role)">
    {{ user?.name?.charAt(0).toUpperCase() }}
  </span>
</button>

  <mat-menu #profilemenu="matMenu" class="topbar-dd cardWithShadow">
 

 <div class="p-x-12 m-t-12">
  {{user?.name}}
 </div>
    <div class="p-x-12 m-t-12">
      <a
        [routerLink]="['/authentication/login']"
        mat-stroked-button
        color="primary"
        class="w-100"
        >Logout</a
      >
    </div>
  </mat-menu> -->
</mat-toolbar>