<!-- src/app/components/user-profile/user-profile.component.html -->
<mat-card class="cardWithShadow">
    <mat-card-content class="p-24">
  
      <!-- Loading -->
      <div *ngIf="loading" class="text-center p-8">
        <mat-spinner diameter="40" class="mx-auto"></mat-spinner>
        <p class="mt-4 text-gray-500">Loading profile...</p>
      </div>
  
      <!-- Error -->
      <div *ngIf="error && !loading" class="text-center p-8">
        <mat-icon class="text-red-500 text-4xl mb-4">error_outline</mat-icon>
        <p class="text-red-500 mb-4">{{ error }}</p>
      </div>
  
      <!-- Content -->
      <div *ngIf="userProfile && !loading" class="profile-container">
  
        <!-- Top role bar -->
        <div class="rolebar">
            <span class="rolepill" [ngClass]="roleChipClass(userProfile.role)">
                {{ roleIcon(userProfile.role) }} {{ roleLabel(userProfile.role) }}
              </span>
        </div>
  
        <!-- Header -->
        <div class="profile-header flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
  
          <!-- Avatar + identity -->
          <div class="flex items-center gap-4">
            <div class="relative">
              <!-- Gradient Initials Avatar -->
              <div *ngIf="!userProfile.avatar"
                   class="w-20 h-20 rounded-full flex items-center justify-center text-white font-semibold text-xl shadow ring-2 ring-white bg-gradient-to-br"
                   [ngClass]="getGradientClass(userProfile.role)">
                {{ getInitials(userProfile.name) }}
              </div>
  
              <!-- Photo Avatar -->
              <img *ngIf="userProfile.avatar"
                   [src]="userProfile.avatar"
                   [alt]="userProfile.name"
                   class="w-20 h-20 rounded-full object-cover shadow ring-2 ring-white">
            </div>
  
            <div>
              <h1 class="text-2xl font-semibold leading-tight mb-0.5">
                {{ userProfile.name }}
              </h1>
              <div class="text-gray-600 mb-1">
                {{ userProfile.position || '‚Äî' }}
              </div>
              <div class="flex items-center gap-2 text-gray-500">
                <mat-icon inline>mail</mat-icon>
                <a class="hover:underline" [href]="'mailto:'+userProfile.email">{{ userProfile.email }}</a>
                <button mat-icon-button (click)="copyEmail(userProfile.email)" matTooltip="Copy email">
                  <mat-icon>content_copy</mat-icon>
                </button>
              </div>
            </div>
          </div>
  
          <!-- Quick meta chips -->
          <div class="flex flex-wrap items-center gap-2">
            <span class="meta-chip"><mat-icon inline>public</mat-icon>{{ userProfile.country_name || 'N/A' }}</span>
            <span class="meta-chip">üè¢ {{ userProfile.entity_name || 'N/A' }}</span>
            <span class="meta-chip">üß© {{ userProfile.unit_name || 'N/A' }}</span>
          </div>
        </div>
  
        <!-- Details grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  
          <!-- Personal Information -->
          <mat-card class="info-card">
            <mat-card-header>
              <mat-card-title class="mat-subtitle-1">Personal Information</mat-card-title>
            </mat-card-header>
            <mat-card-content class="mt-4">
              <div class="info-item mb-4">
                <label class="text-sm font-medium text-gray-500">Full Name</label>
                <p class="mat-body-1">{{ userProfile.name }}</p>
              </div>
              <div class="info-item mb-4">
                <label class="text-sm font-medium text-gray-500">Email Address</label>
                <p class="mat-body-1">{{ userProfile.email }}</p>
              </div>
              <div class="info-item mb-4">
                <label class="text-sm font-medium text-gray-500">Position</label>
                <p class="mat-body-1">{{ userProfile.position || '‚Äî' }}</p>
              </div>
              <div class="info-item">
                <label class="text-sm font-medium text-gray-500">Branch</label>
                <p class="mat-body-1">{{ userProfile.branch || '‚Äî' }}</p>
              </div>
            </mat-card-content>
          </mat-card>
  
          <!-- Organizational Information -->
          <mat-card class="info-card">
            <mat-card-header>
              <mat-card-title class="mat-subtitle-1">Organizational Information</mat-card-title>
            </mat-card-header>
            <mat-card-content class="mt-4">
  
              <div class="info-item mb-4">
                <label class="text-sm font-medium text-gray-500">Role</label>
                <p class="mat-body-1">
                  <span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-sm border"
                        [ngClass]="roleChipClass(userProfile.role)">
                    {{ roleIcon(userProfile.role) }} {{ roleLabel(userProfile.role) }}
                  </span>
                </p>
              </div>
  
              <div class="info-item mb-4">
                <label class="text-sm font-medium text-gray-500">Country</label>
                <p class="mat-body-1">{{ userProfile.country_name || 'N/A' }}</p>
              </div>
  
              <div class="info-item mb-4">
                <label class="text-sm font-medium text-gray-500">Entity</label>
                <p class="mat-body-1">{{ userProfile.entity_name || 'N/A' }}</p>
              </div>
  
              <div class="info-item">
                <label class="text-sm font-medium text-gray-500">Unit</label>
                <p class="mat-body-1">{{ userProfile.unit_name || 'N/A' }}</p>
              </div>
  
            </mat-card-content>
          </mat-card>
        </div>
  
        <!-- Footer -->
        <div *ngIf="userProfile.created_at" class="mt-6 text-center">
          <p class="text-sm text-gray-500">
            Member since {{ userProfile.created_at | date:'longDate' }}
          </p>
        </div>
      </div>
  
    </mat-card-content>
  </mat-card>
